#### **Casos de Uso de la Plataforma Digital SmartPrice**


| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-001                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Consultar y Comparar Precios en Tiempo Real                                                                                                                                                                                                                                                                 |
| **Actor Principal:**                | Cliente / Usuario Final.                                                                                                                                                                                                                                                                                    |
| **Actores Secundarios:**            | Sistema de APIs de Supermercados (Walmart, Soriana, Chedraui, etc.).                                                                                                                                                                                                                                        |
| **Propósito:**                      | Permitir al usuario buscar un producto y obtener una lista consolidada y comparativa de sus precios, disponibilidad y ubicación en diferentes cadenas de supermercados, en tiempo real. **(Corresponde a RF1 y RF3)**                                                                                        |
| **Alcance:**                        | Módulo de Consulta y Comparación en Tiempo Real.                                                                                                                                                                                                                                                            |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario ingresa un criterio de búsqueda en la interfaz principal.                                                                                                                                                                                                                                        |
| **Precondiciones:**                 | 1. Conexión a Internet activa.<br>2. Las APIs de al menos 3 supermercados están disponibles.                                                                                                                                                                                                                |
| **Postcondiciones:**                | 1. Se muestra una lista comparativa de productos.<br>2. La consulta se registra para análisis histórico (RF2).                                                                                                                                                                                               |
| **Flujo Principal:**                | 1. El usuario ingresa el nombre o código de un producto.<br>2. El sistema consulta **concurrentemente** las APIs de los supermercados configurados.<br>3. Se consolidan y normalizan los datos (precio, tienda, disponibilidad, ubicación).<br>4. Se muestran los resultados en una vista unificada, ordenables por precio. |
| **Flujos de Excepción:**            | **E-1: Fallo de API:**<br>1. Si una API no responde, se omite esa tienda de los resultados y se muestra un aviso al usuario.<br>**E-2: Producto no encontrado:**<br>1. El sistema sugiere productos similares.                                                                                                |
| **Reglas de Negocio:**              | **RN-001:** Los precios se deben obtener en tiempo real de las APIs. (RF1).<br>**RN-002:** El tiempo total de respuesta debe ser <3 segundos en el 95% de los casos (RNF-Rendimiento).                                                                                                                        |
| **Requisitos Asociados:**           | **RF1, RF3.** RNF (Rendimiento: <3s), RNF (Confiabilidad: 99% uptime).                                                                                                                                                                                                                                      |


| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-002                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Visualizar Historial y Evolución de Precios                                                                                                                                                                                                                                                                 |
| **Actor Principal:**                | Usuario Frecuente / Registrado.                                                                                                                                                                                                                                                                             |
| **Actores Secundarios:**            | Base de Datos Histórica.                                                                                                                                                                                                                                                                                    |
| **Propósito:**                      | Permitir al usuario visualizar la fluctuación histórica del precio de un producto específico para identificar tendencias y decidir el mejor momento de compra. **(Corresponde a RF2)**                                                                                                                      |
| **Alcance:**                        | Módulo de Análisis Histórico.                                                                                                                                                                                                                                                                               |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario selecciona la opción "Ver Historial" desde la página de detalles de un producto.                                                                                                                                                                                                                  |
| **Precondiciones:**                 | 1. El producto seleccionado existe en la base de datos y tiene al menos una entrada histórica de precios.                                                                                                                                                                                                   |
| **Postcondiciones:**                | 1. Se muestra la gráfica de evolución de precios y/o una tabla con datos históricos.                                                                                                                                                                                                                          |
| **Flujo Principal:**                | 1. El usuario navega a la página de un producto.<br>2. El usuario hace clic en el botón "Ver Historial de Precios".<br>3. El sistema recupera los datos históricos del producto desde la BD.<br>4. El sistema presenta los datos en una visualización clara (gráfica o tabla).                                         |
| **Flujos de Excepción:**            | **E-1: Sin Datos Históricos:**<br>1. Si el producto no tiene historial, se muestra un mensaje: "Aún no hay datos históricos para este producto".                                                                                                                                                              |
| **Reglas de Negocio:**              | **RN-003:** La base de datos debe almacenar cada actualización de precio. (RF2).                                                                                                                                                                                                                              |
| **Requisitos Asociados:**           | **RF2.**                                                                                                                                          



| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-003                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Recibir Predicción de Precios con IA                                                                                                                                                                                                                                                                        |
| **Actor Principal:**                | Usuario.                                                                                                                                                                                                                                                                                                    |
| **Actores Secundarios:**            | Modelo de Inteligencia Artificial, Base de Datos Histórica.                                                                                                                                                                                                                                                 |
| **Propósito:**                      | Utilizar un modelo de IA para predecir posibles aumentos o disminuciones en el precio de un producto y notificar al usuario. **(Corresponde a RF4)**                                                                                                                                                         |
| **Alcance:**                        | Módulo de Predicción de Precios.                                                                                                                                                                                                                                                                            |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario activa la opción "Seguir producto" o consulta un producto con historial suficiente.                                                                                                                                                                                                               |
| **Precondiciones:**                 | 1. El usuario ha iniciado sesión (para alertas).<br>2. El producto a predecir cuenta con un historial de precios suficiente en la BD.                                                                                                                                                                         |
| **Postcondiciones:**                | 1. El usuario recibe una notificación o visualización con la tendencia prevista.                                                                                                                                                                                                                              |
| **Flujo Principal:**                | 1. El usuario activa el "Seguimiento" de un producto.<br>2. El sistema analiza los datos históricos del producto utilizando el modelo de IA.<br>3. El sistema muestra una predicción (ej., "Se prevé una bajada de precios la próxima semana") o programa una alerta automática.                                   |
| **Flujos de Excepción:**            | **E-1: Historial Insuficiente:**<br>1. El sistema muestra un mensaje indicando que no hay suficientes datos para realizar una predicción.                                                                                                                                                                      |
| **Reglas de Negocio:**              | **RN-004:** Las predicciones deben generarse utilizando modelos de IA entrenados con el historial de precios. (RF4).                                                                                                                                                                                           |
| **Requisitos Asociados:**           | **RF4.**                                                                                                                                                                                                                                                                                                    |


| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-004                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Validar Confiabilidad de una Oferta                                                                                                                                                                                                                                                                         |
| **Actor Principal:**                | Consumidor.                                                                                                                                                                                                                                                                                                 |
| **Actores Secundarios:**            | Base de Datos Histórica.                                                                                                                                                                                                                                                                                    |
| **Propósito:**                      | Evaluar y mostrar al usuario un nivel de validez (alta, media, baja) para las ofertas, basándose en su duración histórica y vigencia. **(Corresponde a RF5)**                                                                                                                                               |
| **Alcance:**                        | Módulo de Validación de Ofertas.                                                                                                                                                                                                                                                                            |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario visualiza un producto que está en oferta en la lista de resultados.                                                                                                                                                                                                                              |
| **Precondiciones:**                 | 1. El producto tiene un precio promocional registrado.                                                                                                                                                                                                                                                      |
| **Postcondiciones:**                | 1. La oferta se muestra con una etiqueta de confiabilidad (ej. Alta, Media, Baja).                                                                                                                                                                                                                            |
| **Flujo Principal:**                | 1. El sistema detecta un precio promocional.<br>2. El sistema consulta el historial del producto: duración de ofertas pasadas y fecha de vigencia actual.<br>3. El sistema asigna un nivel de validez basado en reglas predefinidas.<br>4. La etiqueta de confiabilidad se muestra junto al precio de oferta. |
| **Flujos de Excepción:**            | **E-1: Sin Historial de Ofertas:**<br>1. Se asigna la etiqueta "Desconocida" o "Nueva Oferta".                                                                                                                                                                                                                |
| **Reglas de Negocio:**              | **RN-005:** El nivel de validez se asigna en función de la duración histórica y vigencia de la oferta. (RF5).<br>**RN-006:** Una oferta se marca como vencida automáticamente al pasar su fecha de fin.                                                                                                        |
| **Requisitos Asociados:**           | **RF5.**                                                                                                                                                                                                                                                                                                    |


| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-005                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Recomendar Tienda Más Conveniente                                                                                                                                                                                                                                                                           |
| **Actor Principal:**                | Cliente.                                                                                                                                                                                                                                                                                                    |
| **Actores Secundarios:**            | Sistema de Geolocalización.                                                                                                                                                                                                                                                                                 |
| **Propósito:**                      | Analizar el precio del producto y la distancia a la tienda para recomendar la mejor opción, considerando la preferencia del usuario (precio vs. distancia). **(Corresponde a RF6)**                                                                                                                         |
| **Alcance:**                        | Módulo de Optimización de Compra.                                                                                                                                                                                                                                                                           |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario realiza una búsqueda de producto con la geolocalización activada.                                                                                                                                                                                                                                |
| **Precondiciones:**                 | 1. El usuario ha habilitado la ubicación.<br>2. Se ha consultado un producto y se tienen resultados de múltiples tiendas.                                                                                                                                                                                   |
| **Postcondiciones:**                | 1. El sistema sugiere y/o resalta la tienda óptima según los criterios.                                                                                                                                                                                                                                       |
| **Flujo Principal:**                | 1. El usuario busca un producto.<br>2. El sistema obtiene los precios y ubicaciones de las tiendas.<br>3. El sistema calcula la distancia del usuario a cada tienda.<br>4. El sistema aplica un algoritmo de ranking que pondera precio y distancia.<br>5. La tienda con el mejor ranking se sugiere como "Recomendada". |
| **Flujos Alternos:**                | **A-1: Usuario prioriza distancia:**<br>1. El usuario ajusta un filtro para "Priorizar cercanía".<br>2. El sistema reordena los resultados, dando mayor peso a la distancia en el algoritmo.                                                                                                                   |
| **Flujos de Excepción:**            | **E-1: Geolocalización no activa:**<br>1. El sistema muestra los resultados ordenados solo por precio y pide activar la ubicación para una mejor recomendación.                                                                                                                                                |
| **Reglas de Negocio:**              | **RN-007:** La recomendación debe basarse en el menor costo total (precio + transporte implícito por distancia). (RF6).                                                                                                                                                                                       |
| **Requisitos Asociados:**           | **RF6.**                                                                                                                                                                                                                                                                                                    |



| **Elemento**                        | **Descripción**                                                                                                                                                                                                                                                                                             |
| ----------------------------------- | ----------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- |
| **Identificador:**                  | CU-006                                                                                                                                                                                                                                                                                                      |
| **Nombre:**                         | Interactuar con el Asistente Inteligente (Chatbot)                                                                                                                                                                                                                                                          |
| **Actor Principal:**                | Usuario.                                                                                                                                                                                                                                                                                                    |
| **Actores Secundarios:**            | Modelo de LLM (Chatbot), Base de Datos de Precios, Fuente de Datos de Profeco (vía RAG).                                                                                                                                                                                                                     |
| **Propósito:**                      | Brindar atención personalizada mediante un chatbot con IA que resuelva dudas, busque productos y ofrezca recomendaciones utilizando información verificada. **(Corresponde a RF7)**                                                                                                                         |
| **Alcance:**                        | Módulo de Asistente Virtual.                                                                                                                                                                                                                                                                                |
| **Nivel:**                          | Objetivo de Usuario.                                                                                                                                                                                                                                                                                        |
| **Disparador:**                     | El usuario inicia una conversación desde el widget del chatbot en la interfaz.                                                                                                                                                                                                                              |
| **Precondiciones:**                 | 1. El chatbot está disponible y operativo.                                                                                                                                                                                                                                                                  |
| **Postcondiciones:**                | 1. El usuario recibe una respuesta útil y contextual a su consulta.                                                                                                                                                                                                                                           |
| **Flujo Principal:**                | 1. El usuario escribe una pregunta (ej., "¿Dónde están las manzanas más baratas?").<br>2. El chatbot procesa la consulta utilizando el LLM, enriquecido con RAG que accede a la base de datos de precios e información de Profeco.<br>3. El chatbot devuelve una respuesta precisa, con datos concretos y, si es apropiado, enlaces a productos o comparativas. |
| **Flujos de Excepción:**            | **E-1: Consulta no entendida:**<br>1. El chatbot pide amablemente reformular la pregunta o ofrece una lista de opciones comunes de búsqueda.                                                                                                                                                                   |
| **Reglas de Negocio:**              | **RN-008:** El chatbot debe utilizar información verificada de la base de datos interna y de Profeco. (RF7).                                                                                                                                                                                                   |
| **Requisitos Asociados:**           | **RF7.**                                                                                                                                                                                                                                                                                                    |


| **Elemento**                        | **Descripción** |
|---|---|
| **Identificador:** | CU-007 |
| **Nombre:** | Integrar y Validar Datos con Profeco |
| **Actor Principal:** | Sistema (Proceso Automatizado) |
| **Actores Secundarios:** | Fuente de Datos de Profeco, Administrador |
| **Propósito:** | Consultar información de la Profeco automáticamente para asegurar que los precios y ofertas en SmartPrice sean reales y confiables. |
| **Alcance:** | Módulo de Integración con Entidades Externas |
| **Nivel:** | Subfunción (a nivel de sistema) |
| **Disparador:** | Se ejecuta automáticamente cada 24 horas |
| **Precondiciones:** | 1. El sistema tiene acceso a Internet<br>2. La página o API de Profeco está disponible |
| **Postcondiciones:** | 1. La base de datos de SmartPrice se actualiza con información verificada<br>2. Los precios pueden mostrar un sello de "Verificado por Profeco" |
| **Flujo Principal:** | 1. El sistema revisa automáticamente la información de Profeco cada 24 horas<br>2. Compara los precios y ofertas de Profeco con los que tiene en su base de datos<br>3. Si encuentra diferencias, actualiza los precios y marca aquellos que coinciden como "verificados" |
| **Flujos de Excepción:** | **E-1: Profeco no está disponible:**<br>1. El sistema lo intenta de nuevo en 1 hora<br>2. Si después de 3 intentos no funciona, envía un correo de alerta al administrador |
| **Reglas de Negocio:** | **RN-009:** La verificación con Profeco se debe hacer al menos una vez al día |
| **Requisitos Asociados:** | **RF8**, RNF (Legales) |


| **Elemento** | **Descripción** |
|---------------|----------------|
| **Identificador:** | CU-008 |
| **Nombre:** | Iniciar Sesión |
| **Actor Principal:** | Usuario |
| **Propósito:** | Permitir que el usuario acceda a su cuenta mediante la validación de sus credenciales para utilizar las funcionalidades personalizadas del sistema. |
| **Disparador:** | El usuario selecciona la opción **“Iniciar Sesión”** en la pantalla principal de la aplicación. |
| **Precondiciones:** | - El usuario debe contar con una cuenta registrada en el sistema.<br>- En caso de ser un usuario nuevo, podrá acceder registrarse antes de iniciar sesión.<br>- El sistema debe tener conexión con la base de datos de usuarios. |
| **Flujo Principal:** | 1. El usuario selecciona la opción **“Iniciar Sesión”**.<br>2. El sistema muestra el formulario de autenticación.<br>3. El usuario introduce su **correo electrónico** y **contraseña**.<br>4. El sistema valida las credenciales comparándolas con la base de datos.<br>5. Si las credenciales son correctas, el sistema permite el acceso y muestra la interfaz principal personalizada.<br>6. El sistema registra la fecha y hora del inicio de sesión. |
| **Flujos de Excepción:** | - **E1:** Si el usuario introduce credenciales incorrectas, el sistema muestra el mensaje: *“Correo o contraseña incorrectos”* y permite reintentar.<br>- **E2:** Si el usuario no posee una cuenta registrada, el sistema muestra el mensaje: *“No se encontró una cuenta con este correo”* y ofrece la opción **“Registrarse”*.<br>- **E3:** Si no hay conexión a internet, el sistema muestra el mensaje: *“No hay conexión, inténtelo más tarde”*.<br>- **E4:** Si la cuenta se encuentra bloqueada por múltiples intentos fallidos, el sistema muestra: *“Su cuenta ha sido temporalmente bloqueada por seguridad”*. |
| **Postcondiciones:** | - El usuario accede correctamente a su cuenta y puede gestionar sus preferencias o utilizar las funciones del sistema.<br>- El sistema registra la sesión activa y actualiza el historial de accesos. |
| **Reglas de Negocio:** | - Las credenciales deben coincidir exactamente con las registradas en la base de datos.<br>- Después de **tres intentos fallidos**, la cuenta se bloquea temporalmente por motivos de seguridad.<br>- Las contraseñas deben almacenarse de forma **cifrada** conforme a la **Ley Federal de Protección de Datos Personales**. |
| **Requisitos Asociados:** | RF8, RNF (Protección de datos) |


| **Elemento** | **Descripción** |
|---------------|----------------|
| **Identificador:** | CU-009 |
| **Nombre:** | Recibir Notificaciones de Ofertas |
| **Actor Principal:** | Usuario Registrado |
| **Propósito:** | Permitir que el usuario reciba notificaciones automáticas cuando los productos que sigue presenten una reducción de precio significativa. |
| **Disparador:** | El sistema detecta una disminución en el precio de un producto seguido por el usuario. |
| **Precondiciones:** | - El usuario debe haber iniciado sesión y tener activa la opción de **seguimiento de productos**.<br>- Los productos deben estar registrados en la base de datos con historial de precios.<br>- El sistema debe tener conexión a internet y acceso a la base de datos de productos. |
| **Flujo Principal:** | 1. El usuario activa la opción **“Seguir producto”** desde la página del producto.<br>2. El sistema registra el producto en la lista de seguimiento del usuario.<br>3. El sistema monitorea periódicamente los precios de los productos seguidos.<br>4. Si se detecta una reducción de **≥ 5%**, el sistema genera una notificación.<br>5. El usuario recibe la alerta en la aplicación o por el canal de comunicación configurado. |
| **Flujos de Excepción:** | - **E1:** Si el producto deja de estar disponible, el sistema elimina el seguimiento y notifica al usuario.<br>- **E2:** Si las notificaciones están desactivadas, el sistema guarda el evento pero no envía alerta.<br>- **E3:** Si el sistema no puede acceder a la base de datos, muestra un mensaje de error y registra el fallo para revisión. |
| **Postcondiciones:** | - El usuario recibe la notificación correspondiente cuando se cumple la condición de descuento.<br>- El sistema mantiene actualizada la lista de productos seguidos. |
| **Reglas de Negocio:** | - Solo se enviarán notificaciones cuando el precio del producto disminuya en **al menos un 5%**.<br>- Las notificaciones deben entregarse al usuario en tiempo razonable después de detectarse la baja de precio. |
| **Requisitos Asociados:** | RF10 |


